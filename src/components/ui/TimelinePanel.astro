---
import type { Experience, Education } from '../../types/portfolio';

interface Props {
  item: Experience | Education;
  index: number;
  id: string;
}

const { item, index, id } = Astro.props;
const isExp = (i: Experience | Education): i is Experience => 'company' in i;
---

<div
  id={`${id}-panel-${index}`}
  class="timeline-panel hidden absolute left-0 w-full max-w-sm p-4 rounded-xl bg-(--color-bg-secondary) border border-(--color-border) shadow-xl z-50"
  data-panel-index={index}
>
  <h4 class="font-semibold text-(--color-text)">
    {isExp(item) ? item.title : item.degree}
  </h4>
  <p class="text-xs text-(--color-accent)">{item.period}</p>
  <p class="text-sm text-(--color-text-secondary)">
    {isExp(item) ? `${item.company} · ${item.location}` : item.institution}
  </p>
  {
    item.description && (
      <p class="text-sm text-(--color-text-muted) mt-2">{item.description}</p>
    )
  }
  {
    isExp(item) && item.bullets.length > 0 && (
      <ul class="mt-2 space-y-1">
        {item.bullets.slice(0, 3).map((b) => (
          <li class="text-sm text-(--color-text-muted)">→ {b}</li>
        ))}
      </ul>
    )
  }
</div>

<style>
  .timeline-panel.active {
    display: block;
    animation: fadeIn 0.2s;
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
    }
  }
</style>
