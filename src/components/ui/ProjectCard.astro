---
import type { Project } from '../../types/portfolio';

interface Props {
  project: Project;
}

const { project } = Astro.props;
const Tag = project.isComingSoon ? 'div' : 'a';
---

<Tag
  href={project.isComingSoon ? undefined : `/projects/${project.slug}`}
  class:list={[
    'project-card group block rounded-xl overflow-hidden border border-(--color-border) bg-(--color-bg-secondary) transition-all duration-300',
    project.isComingSoon
      ? 'opacity-60 cursor-not-allowed'
      : 'hover:border-(--color-accent) hover:shadow-lg',
  ]}
>
  <!-- Image with View Transition -->
  {
    project.image ? (
      <div class="aspect-video overflow-hidden bg-(--color-bg-tertiary)">
        <img
          src={project.image}
          alt={project.title}
          class="w-full h-full object-cover object-top transition-transform duration-500 group-hover:scale-105"
          loading="lazy"
          width="600"
          height="338"
          transition:name={`img-${project.slug}`}
        />
      </div>
    ) : (
      <div class="aspect-video bg-(--color-bg-tertiary) flex items-center justify-center">
        <span class="text-4xl">ðŸš§</span>
      </div>
    )
  }

  <!-- Content -->
  <div class="p-5">
    <div class="flex items-start justify-between gap-2 mb-2">
      <h3
        class="text-lg font-semibold text-(--color-text) group-hover:text-(--color-accent) transition-colors"
        transition:name={`title-${project.slug}`}
      >
        {project.title}
      </h3>
      {
        project.isComingSoon && (
          <span class="pill rounded-full">PrÃ³ximamente</span>
        )
      }
    </div>

    <p class="text-sm text-(--color-text-secondary) mb-3 line-clamp-2">
      {project.tagline}
    </p>

    <!-- Stack pills (text only) -->
    <div class="flex flex-wrap gap-1.5">
      {
        project.stack
          .slice(0, 4)
          .map((tech) => <span class="pill">{tech}</span>)
      }
      {
        project.stack.length > 4 && (
          <span class="pill">+{project.stack.length - 4}</span>
        )
      }
    </div>
  </div>
</Tag>
